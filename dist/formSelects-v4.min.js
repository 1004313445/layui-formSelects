"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(e,t,n){if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=n()}else if(typeof define==="function"&&define.amd){define(n)}else if(t.layui&&e.define){e.define(["jquery"],function(e){e("formSelects",n())})}else{t.formSelects=n()}})(typeof layui=="undefined"?null:layui,window,function(){var n="4.1.0.0726.beta",m="xm-select",v="xm-select-parent",y="xm-select-input",g="xm-select--suffix",x="xm-select-this",k="xm-select-label",b="xm-select-search",C="xm-select-search-type",w="xm-select-show-count",S="xm-select-create",d="xm-select-create-long",T="xm-select-max",j="xm-select-skin",A="xm-select-direction",L="xm-select-height",N="xm-dis-disabled",H="xm-select-dis",p="xm-select-temp",E="xm-select-radio",F="xm-select-linkage",D="xm-select-dl",h="xm-select-hide",O="xm-hide-input",V="xm-select-sj",e="xm-icon-close",P="xm-select-title",I="xm-form-select",f="xm-form-selected",_="xm-select-none",U="xm-select-empty",M="xm-input",W="xm-dl-input",B="xm-select-tips",r="iconfont",q="xm-cz",l="xm-cz-group",J="请选择",z={},Q={on:{},endOn:{},filter:{},maxTips:{}},X={type:"get",header:{},first:true,data:{},searchUrl:"",searchName:"keyword",searchVal:null,keyName:"name",keyVal:"value",keySel:"selected",keyDis:"disabled",keyChildren:"children",dataType:"",delay:500,beforeSuccess:null,success:null,error:null,beforeSearch:null,response:{statusCode:0,statusName:"code",msgName:"msg",dataName:"data"}},Y={},a={},i={},$=[{icon:"iconfont icon-quanxuan",name:"全选",click:function e(t,n){n.selectAll(t,true,true)}},{icon:"iconfont icon-qingkong",name:"清空",click:function e(t,n){n.removeAll(t,true,true)}},{icon:"iconfont icon-fanxuan",name:"反选",click:function e(t,n){n.reverse(t,true,true)}},{icon:"iconfont icon-pifu",name:"换肤",click:function e(t,n){n.skin(t)}}],G=window.$||window.layui&&window.layui.jquery,o=window.Vue||null,s=G(window),K=function e(t){var l=this;this.config={name:null,max:null,maxTips:function e(t,n,a,i){var r=G('[xid="'+l.config.name+'"]').prev().find("."+m);if(r.parents(".layui-form-item[pane]").length){r=r.parents(".layui-form-item[pane]")}r.attr("style","border-color: red !important");setTimeout(function(){r.removeAttr("style")},300)},init:null,on:null,endOn:null,filter:function e(t,n,a,i){return a.name.indexOf(n)==-1},clearid:-1,direction:"auto",height:null,isEmpty:false,btns:null,searchType:0,create:function e(t,n){return Date.now()},template:function e(t,n,a,i){return t},showCount:0,isCreate:false,placeholder:J,clearInput:false};this.select=null;this.values=[];G.extend(this.config,i[t.name]||a);G.extend(this.config,t);if(isNaN(this.config.showCount)||this.config.showCount<=0){this.config.showCount=19921012}};var t=function e(){this.appender();this.on();this.onreset()};t.prototype.appender=function(){if(!Array.prototype.map){Array.prototype.map=function(e,t){var n,a,i,r=Object(this),l=r.length>>>0;if(t){n=t}a=new Array(l);i=0;while(i<l){var s,o;if(i in r){s=r[i];o=e.call(n,s,i,r);a[i]=o}i++}return a}}if(!Array.prototype.forEach){Array.prototype.forEach=function e(t,n){var a,i;if(this==null){throw new TypeError("this is null or not defined")}var r=Object(this);var l=r.length>>>0;if(typeof t!=="function"){throw new TypeError(t+" is not a function")}if(arguments.length>1){a=n}i=0;while(i<l){var s;if(i in r){s=r[i];t.call(a,s,i,r)}i++}}}if(!Array.prototype.filter){Array.prototype.filter=function(e){if(this===void 0||this===null){throw new TypeError}var t=Object(this);var n=t.length>>>0;if(typeof e!=="function"){throw new TypeError}var a=[];var i=arguments[1];for(var r=0;r<n;r++){if(r in t){var l=t[r];if(e.call(i,l,r,t)){a.push(l)}}}return a}}};t.prototype.init=function(e){var h=this;G(e?e:"select["+m+"]").each(function(e,t){var n=G(t),a=n.attr(m),i=n.next(".layui-form-select"),r=n.next("."+v),l={name:a,disabled:t.disabled,max:n.attr(T)-0,isSearch:n.attr(b)!=undefined,searchUrl:h.isSearch?n.attr(b):null,isCreate:n.attr(S)!=undefined,radio:n.attr(E)!=undefined,skin:n.attr(j),direction:n.attr(A),optionsFirst:t.options[0],height:n.attr(L),formname:n.attr("name")||n.attr("_name"),layverify:n.attr("lay-verify"),layverType:n.attr("lay-verType"),searchtype:n.attr(C)=="dl"?1:0,showCount:n.attr(w)-0,placeholder:h.optionsFirst?h.optionsFirst.value?J:h.optionsFirst.innerHTML||J:J,btns:h.radio?[$[1]]:[$[0],$[1],$[2]]},s=n.find("option[selected]").toArray().map(function(e){return{name:e.innerHTML,val:e.value}}),o=new K(l);o.values=s;if(o.config.init){o.values=o.config.init.map(function(e){if((typeof e==="undefined"?"undefined":_typeof(e))=="object"){return e}return{name:n.find('option[value="'+e+'"]').text(),val:e}}).filter(function(e){return e.name});o.config.init=o.values.concat([])}else{o.config.init=s.concat([])}!o.values&&(o.values=[]);z[a]=o;i[0]&&i.remove();r[0]&&r.remove();var d=h.renderSelect(a,o.config.placeholder,t);var c=!o.config.height||o.config.height=="auto"?"":'xm-hg style="height: 34px;"';var f=['<div class="'+k+'">','<input type="text" fsw class="'+M+" "+y+'" '+(o.config.isSearch?"":'style="display: none;"')+' autocomplete="off" debounce="0" />',"</div>"];var u=G('<div class="'+I+'" '+j+'="'+o.config.skin+'">\n\t\t\t\t\t<input class="'+O+'" value="" name="'+o.config.formname+'" lay-verify="'+o.config.layverify+'" lay-verType="'+o.config.layverType+'" type="text" style="position: absolute;bottom: 0; z-index: -1;width: 100%; height: 100%; border: none; opacity: 0;"/>\n\t\t\t\t\t<div class="'+P+" "+(o.config.disabled?H:"")+'">\n\t\t\t\t\t\t<div class="'+M+" "+m+'" '+c+">\n\t\t\t\t\t\t\t"+f.join("")+'\n\t\t\t\t\t\t\t<i class="'+V+'"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="'+g+'">\n\t\t\t\t\t\t\t<input type="text" autocomplete="off" placeholder="'+o.config.placeholder+'" readonly="readonly" unselectable="on" class="'+M+'">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<dl xid="'+a+'" class="'+D+" "+(o.config.radio?E:"")+'">'+d+"</dl>\n\t\t\t\t</div>");var p=G('<div class="'+v+'" FS_ID="'+a+'"></div>');p.append(u);n.after(p);n.attr("lay-ignore","");n.removeAttr("name")&&n.attr("_name",o.config.formname);if(o.config.isSearch){Y[a]=G.extend(true,{},X,{searchUrl:o.config.searchUrl});G(document).on("input","div."+v+'[FS_ID="'+a+'"] .'+y,function(e){h.search(a,e,o.config.searchUrl)});if(o.config.searchUrl){h.triggerSearch(u,true)}}else{u.find("dl dd."+W).css("display","none")}})};t.prototype.search=function(i,e,t,n){var a=this;var r=void 0;if(n){r=n}else{r=e.target;var l=e.keyCode;if(l===9||l===13||l===37||l===38||l===39||l===40){return false}}var s=G.trim(r.value);this.changePlaceHolder(G(r));var o=Y[i]?Y[i]:X;t=o.searchUrl||t;var d=z[i],c=d.config.isCreate,f=G('dl[xid="'+i+'"]').parents("."+I);if(t){if(o.searchVal){s=o.searchVal;o.searchVal=""}if(!o.beforeSearch||o.beforeSearch&&o.beforeSearch instanceof Function&&o.beforeSearch(i,t,s)){var u=o.delay;if(o.first){o.first=false;u=10}clearTimeout(d.clearid);d.clearid=setTimeout(function(){f.find("dl > *:not(."+B+")").remove();f.find("dd."+_).addClass(U).text("请求中");a.ajax(i,t,s,false,null,true)},u)}}else{f.find("dl ."+h).removeClass(h);f.find("dl dd:not(."+B+")").each(function(e,t){var n=G(t);var a=Q.filter[i]||z[i].config.filter;if(a&&a(i,s,{name:n.find("span").attr("name"),val:n.attr("lay-value")},n.hasClass(N))==true){n.addClass(h)}});f.find("dl dt").each(function(e,t){if(!G(t).nextUntil("dt",":not(."+h+")").length){G(t).addClass(h)}});this.create(i,c,s);var p=f.find("dl dd:not(."+B+"):not(."+h+")");if(!p.length){f.find("dd."+_).addClass(U).text("无匹配项")}else{f.find("dd."+_).removeClass(U)}}};t.prototype.isArray=function(e){return Object.prototype.toString.call(e)=="[object Array]"};t.prototype.triggerSearch=function(e,a){var i=this;(e?[e]:G("."+I).toArray()).forEach(function(e,t){e=G(e);var n=e.find("dl").attr("xid");if(n&&z[n]&&z[n].config.isEmpty||a){i.search(n,null,null,z[n].config.searchType==0?e.find("."+k+" ."+y):e.find("dl ."+W+" ."+y))}})};t.prototype.clearInput=function(e){var t=G("."+v+'[fs_id="'+e+'"]');var n=z[e].config.searchType==0?t.find("."+k+" ."+y):t.find("dl ."+W+" ."+y);n.val("")};t.prototype.ajax=function(a,i,r,l,s,o){var d=this;var c=G("."+v+' dl[xid="'+a+'"]').parents("."+I);if(!c[0]||!i){return}var f=Y[a]?Y[a]:X;var e=G.extend(true,{},f.data);e[f.searchName]=r;G.ajax({type:f.type,headers:f.header,url:i,data:f.dataType=="json"?JSON.stringify(e):e,success:function e(t){if(typeof t=="string"){t=JSON.parse(t)}f.beforeSuccess&&f.beforeSuccess instanceof Function&&(t=f.beforeSuccess(a,i,r,t));if(d.isArray(t)){var n={};n[f.response.statusName]=f.response.statusCode;n[f.response.msgName]="";n[f.response.dataName]=t;t=n}if(t[f.response.statusName]!=f.response.statusCode){c.find("dd."+_).addClass(U).text(t[f.response.msgName])}else{c.find("dd."+_).removeClass(U);d.renderData(a,t[f.response.dataName],l,s,o);z[a].config.isEmpty=t[f.response.dataName].length==0}f.success&&f.success instanceof Function&&f.success(a,i,r,t)},error:function e(t){c.find("dd[lay-value]:not(."+B+")").remove();c.find("dd."+_).addClass(U).text("服务异常");f.error&&f.error instanceof Function&&f.error(a,i,r,t)}})};t.prototype.renderData=function(r,o,e,d,t){var n=this;if(e){var a=function(){var n=[],a=0,l={0:o},s=Y[r]?Y[r]:X;var e=function e(){var r=n[a++]=[],t=l;l={};G.each(t,function(i,e){G.each(e,function(e,t){var n={pid:i,name:t[s.keyName],val:t[s.keyVal]};r.push(n);var a=t[s.keyChildren];if(a&&a.length){l[n.val]=a}})})};do{e()}while(Object.getOwnPropertyNames(l).length);var t=G("."+v+' dl[xid="'+r+'"]').parents("."+I);var i=['<div class="xm-select-linkage">'];G.each(n,function(e,t){var a=['<div style="left: '+(d-0)*e+'px;" class="xm-select-linkage-group xm-select-linkage-group'+(e+1)+" "+(e!=0?"xm-select-linkage-hide":"")+'">'];G.each(t,function(e,t){var n='<li title="'+t.name+'" pid="'+t.pid+'" value="'+t.val+'"><span>'+t.name+"</span></li>";a.push(n)});a.push("</div>");i=i.concat(a)});i.push('<div style="clear: both; height: 288px;"></div>');i.push("</div>");t.find("dl").html(i.join(""));t.find("."+y).css("display","none");return{v:void 0}}();if((typeof a==="undefined"?"undefined":_typeof(a))==="object")return a.v}var i=G("."+v+' dl[xid="'+r+'"]').parents("."+I);var l=Y[r]?Y[r]:X;var s=i.find("."+g+" input");var c=[];i.find("dl").html(this.renderSelect(r,s.attr("placeholder")||s.attr("back"),o.map(function(e){if(e[l.keySel]){c.push({name:e[l.keyName],val:e[l.keyVal]})}return{innerHTML:e[l.keyName],value:e[l.keyVal],sel:e[l.keySel],disabled:e[l.keyDis],type:e.type,name:e.name}})));var f=i.find("."+k);var u=i.find("dl[xid]");if(t){var p=z[r].values;p.forEach(function(e,t){u.find('dd[lay-value="'+e.val+'"]').addClass(x)});c.forEach(function(e,t){if(n.indexOf(p,e)==-1){n.addLabel(r,f,e);u.find('dd[lay-value="'+e.val+'"]').addClass(x);p.push(e)}})}else{c.forEach(function(e,t){n.addLabel(r,f,e);u.find('dd[lay-value="'+e.val+'"]').addClass(x)});z[r].values=c}this.commonHanler(r,f)};t.prototype.create=function(e,t,n){if(t&&n){var a=z[e],i=G('[xid="'+e+'"]'),r=i.find("dd."+B+"."+W),l=null,s=i.find("dd."+p);i.find("dd:not(."+B+"):not(."+p+")").each(function(e,t){if(n==G(t).find("span").attr("name")){l=t}});if(!l){var o=a.config.create(e,n);if(s[0]){s.attr("lay-value",o);s.find("span").text(n);s.find("span").attr("name",n);s.removeClass(h)}else{r.after(G(this.createDD(e,{innerHTML:n,value:o},p+" "+d)))}}}else{G("[xid="+e+"] dd."+p).remove()}};t.prototype.createDD=function(e,t,n){var a=G.trim(t.innerHTML);var i=z[e].config.template(a,t.value,t.selected,t.disabled);return'<dd lay-value="'+t.value+'" class="'+(t.disabled?N:"")+" "+(n?n:"")+'">\n\t\t\t\t\t<div class="xm-unselect xm-form-checkbox '+(t.disabled?N:"")+'">\n\t\t\t\t\t\t<i class="'+r+'"></i>\n\t\t\t\t\t\t<span name="'+a+'">'+i+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</dd>"};t.prototype.createQuickBtn=function(e,t){return'<div class="'+q+'" method="'+e.name+'" title="'+e.name+'" '+(t?'style="margin-right: '+t+'"':"")+'><i class="'+e.icon+'"></i><span>'+e.name+"</span></div>"};t.prototype.renderBtns=function(e,t,n){var a=this;var i=[];var r=G('dl[xid="'+e+'"]');i.push('<div class="'+l+'" show="'+t+'" style="max-width: '+(r.prev().width()-54)+'px;">');G.each(z[e].config.btns,function(e,t){i.push(a.createQuickBtn(t,n))});i.push("</div>");i.push(this.createQuickBtn({icon:"iconfont icon-caidan",name:""}));return i.join("")};t.prototype.renderSelect=function(n,e,t){var a=this;var i=[];if(z[n].config.btns.length){setTimeout(function(){var e=G('dl[xid="'+n+'"]');e.parents("."+I).attr(C,z[n].config.searchType);e.find("."+l).css("max-width",e.prev().width()-54+"px")},10);i.push(['<dd lay-value="" class="'+B+'" style="background-color: #FFF!important;">',this.renderBtns(n,null,"30px"),"</dd>",'<dd lay-value="" class="'+B+" "+W+'" style="background-color: #FFF!important;">','<i class="iconfont icon-sousuo"></i>','<input type="text" class="'+M+" "+y+'" placeholder="请搜索"/>',"</dd>"].join(""))}else{i.push('<dd lay-value="" class="'+B+'">'+e+"</dd>")}if(this.isArray(t)){G(t).each(function(e,t){if(t){if(t.type&&t.type==="optgroup"){i.push("<dt>"+t.name+"</dt>")}else{i.push(a.createDD(n,t))}}})}else{G(t).find("*").each(function(e,t){if(t.tagName.toLowerCase()=="option"&&e==0&&!t.value){return}if(t.tagName.toLowerCase()==="optgroup"){i.push("<dt>"+t.label+"</dt>")}else{i.push(a.createDD(n,t))}})}i.push('<dt style="display:none;"> </dt>');i.push('<dd class="'+B+" "+_+" "+(i.length===2?U:"")+'">没有选项</dd>');return i.join("")};t.prototype.on=function(){var n=this;this.one();G(document).on("click",function(e){if(!G(e.target).parents("."+P)[0]){G("."+v+" dl ."+h).removeClass(h);G("."+v+" dl dd."+U).removeClass(U);G("."+v+" dl dd."+p).remove();G.each(z,function(e,t){n.clearInput(e);if(!t.values.length){n.changePlaceHolder(G('div[FS_ID="'+e+'"] .'+k))}})}G("."+v+" ."+f).removeClass(f)})};t.prototype.calcLabelLeft=function(e,t,n){var a=this.getPosition(e[0]);a.y=a.x+e[0].clientWidth;var i=e[0].offsetLeft;if(!e.find("span").length){i=0}else if(n){var r=e.find("span:last");r.css("display")=="none"?r=r.prev()[0]:r=r[0];var l=this.getPosition(r);l.y=l.x+r.clientWidth;if(l.y>a.y){i=i-(l.y-a.y)-5}else{i=0}}else{if(t<0){var s=e.find(":last");s.css("display")=="none"?s=s.prev()[0]:s=s[0];var o=this.getPosition(s);o.y=o.x+s.clientWidth;if(o.y>a.y){i-=10}}else{if(i<0){i+=10}if(i>0){i=0}}}e.css("left",i+"px")};t.prototype.one=function(e){var v=this;G(e?e:document).off("click","."+P).on("click","."+P,function(e){var t=G(e.target),n=t.is(P)?t:t.parents("."+P),a=n.next(),i=a.attr("xid");G("dl[xid]").not(a).each(function(e,t){v.clearInput(G(t).attr("xid"))});G("dl[xid]").not(a).find("dd."+h).removeClass(h);if(n.hasClass(H)){return false}if(t.is("."+V)||t.is("."+y+"[readonly]")){v.changeShow(n,!n.parents("."+I).hasClass(f));return false}if(n.find("."+y+":not(readonly)")[0]){var r=n.find("."+y),l={x:e.pageX,y:e.pageY},s=v.getPosition(n[0]),o=n.width();while(l.x>s.x){if(G(document.elementFromPoint(l.x,l.y)).is(r)){r.focus();v.changeShow(n,true);return false}l.x-=50}}if(t.is("."+y)){v.changeShow(n,true);return false}if(t.is('i[fsw="'+m+'"]')){var d={name:t.prev().text(),val:t.parent().attr("value")},c=a.find("dd[lay-value='"+d.val+"']");if(c.hasClass(N)){return false}v.handlerLabel(i,c,false,d);return false}v.changeShow(n,!n.parents("."+I).hasClass(f));return false});G(e?e:document).off("click","dl."+D).on("click","dl."+D,function(e){var t=G(e.target);if(t.is("."+F)||t.parents("."+F)[0]){t=t.is("li")?t:t.parents("li");var n=t.parents(".xm-select-linkage-group"),a=t.parents("dl").attr("xid");if(!a){return false}n.find(".xm-select-active").removeClass("xm-select-active");t.addClass("xm-select-active");n.nextAll(".xm-select-linkage-group").addClass("xm-select-linkage-hide");var i=n.next(".xm-select-linkage-group");i.find("li").addClass("xm-select-linkage-hide");i.find('li[pid="'+t.attr("value")+'"]').removeClass("xm-select-linkage-hide");if(!i[0]||i.find("li:not(.xm-select-linkage-hide)").length==0){var r=[],l=0,s=!t.hasClass("xm-select-this");if(z[a].config.radio){t.parents(".xm-select-linkage").find(".xm-select-this").removeClass("xm-select-this")}do{r[l++]={name:t.find("span").text(),val:t.attr("value")};t=t.parents(".xm-select-linkage-group").prev().find('li[value="'+t.attr("pid")+'"]')}while(t.length);r.reverse();var o={name:r.map(function(e){return e.name}).join("/"),val:r.map(function(e){return e.val}).join("/")};v.handlerLabel(a,null,s,o)}else{i.removeClass("xm-select-linkage-hide")}return false}if(t.is("dl")){return false}if(t.is("dt")){t.nextUntil("dt").each(function(e,t){t=G(t);if(t.hasClass(N)||t.hasClass(x)){}else{t.click()}});return false}var d=t.is("dd")?t:t.parents("dd");var c=d.parent("dl").attr("xid");if(d.hasClass(N)){return false}if(d.hasClass(B)){var f=t.is("."+q)?t:t.parents("."+q);if(!f[0]){return false}var u=f.attr("method");var p=z[c].config.btns.filter(function(e){return e.name==u})[0];p&&p.click&&p.click instanceof Function&&p.click(c,v);return false}var h=!d.hasClass(x);v.handlerLabel(c,d,h);return false})};t.prototype.linkageAdd=function(e,t){var n=G('dl[xid="'+e+'"]');n.find(".xm-select-active").removeClass("xm-select-active");var a=t.val.split("/");var i=void 0,r=void 0,l=0;var s=[];do{i=a[l];r=n.find(".xm-select-linkage-group"+(l+1)+' li[value="'+i+'"]');r[0]&&s.push(r);l++}while(r.length&&i!=undefined);if(s.length==a.length){G.each(s,function(e,t){t.addClass("xm-select-this")})}};t.prototype.linkageDel=function(e,t){var n=G('dl[xid="'+e+'"]');var a=t.val.split("/");var i=void 0,r=void 0,l=a.length-1;do{i=a[l];r=n.find(".xm-select-linkage-group"+(l+1)+' li[value="'+i+'"]');if(!r.parent().next().find("li[pid="+i+"].xm-select-this").length){r.removeClass("xm-select-this")}l--}while(r.length&&i!=undefined)};t.prototype.valToName=function(e,t){var a=G('dl[xid="'+e+'"]');var n=(t+"").split("/");if(!n.length){return null}var i=[];G.each(n,function(e,t){var n=a.find(".xm-select-linkage-group"+(e+1)+' li[value="'+t+'"] span').text();i.push(n)});return i.length==n.length?i.join("/"):null};t.prototype.commonHanler=function(e,t){if(!t||!t[0]){return}this.checkHideSpan(e,t);this.changePlaceHolder(t);this.retop(t.parents("."+I));this.calcLabelLeft(t,0,true);this.setHidnVal(e,t);t.parents("."+P+" ."+m).attr("title",z[e].values.map(function(e){return e.name}).join(","))};t.prototype.setHidnVal=function(e,t){if(!t||!t[0]){return}t.parents("."+v).find("."+O).val(z[e].values.map(function(e){return e.val}).join(","))};t.prototype.initVal=function(e){var s=this;var t={};if(e){t[e]=z[e]}else{t=z}G.each(t,function(n,e){var t=e.values,a=G('dl[xid="'+n+'"]').parent(),i=a.find("."+k),r=a.find("dl");r.find("dd."+x).removeClass(x);var l=t.concat([]);l.concat([]).forEach(function(e,t){s.addLabel(n,i,e);r.find('dd[lay-value="'+e.val+'"]').addClass(x)});if(e.config.radio){l.length&&t.push(l[l.length-1])}s.commonHanler(n,i)})};t.prototype.handlerLabel=function(e,t,n,a,i){var r=G('[xid="'+e+'"]').prev().find("."+k),l=t&&{name:t.find("span").attr("name"),val:t.attr("lay-value")},s=z[e].values,o=z[e].config.on||Q.on[e],d=z[e].config.endOn||Q.endOn[e];if(a){l=a}var c=z[e];if(n&&c.config.max&&c.values.length>=c.config.max){var f=Q.maxTips[e]||z[e].config.maxTips;f&&f(e,s.concat([]),l,c.config.max);return}if(!i){if(o&&o instanceof Function&&o(e,s.concat([]),l,n,t&&t.hasClass(N))==false){return}}var u=G('dl[xid="'+e+'"]');n?(t&&t[0]?(t.addClass(x),t.removeClass(p)):u.find(".xm-select-linkage")[0]&&this.linkageAdd(e,l),this.addLabel(e,r,l),s.push(l)):(t&&t[0]?t.removeClass(x):u.find(".xm-select-linkage")[0]&&this.linkageDel(e,l),this.delLabel(e,r,l),this.remove(s,l));if(!r[0])return;if(c.config.radio){this.changeShow(r,false)}r.parents("."+P).prev().removeClass("layui-form-danger");c.config.clearInput&&this.clearInput(e);this.commonHanler(e,r);!i&&d&&d instanceof Function&&d(e,s.concat([]),l,n,t&&t.hasClass(N))};t.prototype.addLabel=function(e,t,n){if(!n)return;var a='fsw="'+m+'"';var i=[G("<span "+a+' value="'+n.val+'"><font '+a+">"+n.name+"</font></span>"),G("<i "+a+' class="iconfont icon-close"></i>')],r=i[0],l=i[1];r.append(l);var s=z[e];if(s.config.radio){s.values.length=0;G('dl[xid="'+e+'"]').find("dd."+x+':not([lay-value="'+n.val+'"])').removeClass(x);t.find("span").remove()}t.find("input").css("width","50px");t.find("input").before(r)};t.prototype.delLabel=function(e,t,n){if(!n)return;t.find('span[value="'+n.val+'"]:first').remove()};t.prototype.checkHideSpan=function(e,t){var n=t.parents("."+m)[0].offsetHeight+5;t.find("span.xm-span-hide").removeClass("xm-span-hide");t.find("span[style]").remove();var a=z[e].config.showCount;t.find("span").each(function(e,t){if(e>=a){G(t).addClass("xm-span-hide")}});var i=t.find("span:eq("+a+")");i[0]&&i.before(G('<span style="padding-right: 6px;" fsw="'+m+'"> + '+(t.find("span").length-a)+"</span>"))};t.prototype.retop=function(e){var t=e.find("dl"),n=e.offset().top+e.outerHeight()+5-s.scrollTop(),a=t.outerHeight();var i=e.hasClass("layui-form-selectup")||t.css("top").indexOf("-")!=-1||n+a>s.height()&&n>=a;e=e.find("."+m);var r=z[t.attr("xid")];var l=t.parents(".layui-form-pane")[0]&&t.prev()[0].clientHeight>38?14:10;if(r){if(r.config.direction=="up"){t.css({top:"auto",bottom:"42px"});return}if(r.config.direction=="down"){t.css({top:e[0].offsetTop+e.height()+l+"px",bottom:"auto"});return}}if(i){t.css({top:"auto",bottom:"42px"})}else{t.css({top:e[0].offsetTop+e.height()+l+"px",bottom:"auto"})}};t.prototype.changeShow=function(e,t){G(".layui-form-selected").removeClass("layui-form-selected");G(".layui-laydate").remove();var n=e.parents("."+I);G("."+v+" ."+I).not(n).removeClass(f);if(t){this.retop(n);n.addClass(f);n.find("."+y).focus();if(!n.find("dl dd[lay-value]:not(."+B+")").length){n.find("dl ."+_).addClass(U)}}else{var a=n.find("dl").attr("xid");n.removeClass(f);this.clearInput(a);n.find("dl ."+U).removeClass(U);n.find("dl dd."+h).removeClass(h);n.find("dl dd."+p).remove();if(a&&z[a]&&z[a].config.isEmpty){this.triggerSearch(n)}this.changePlaceHolder(n.find("."+k))}};t.prototype.changePlaceHolder=function(e){var t=e.parents("."+P);t[0]||(t=e.parents("dl").prev());if(!t[0]){return}var n=e.parents("."+v).find("dl[xid]").attr("xid");if(z[n]&&z[n].config.height){}else{var a=t.find("."+m)[0].clientHeight;t.css("height",(a>34?a+4:a)+"px");var i=t.parents("."+v).parent().prev();if(i.is(".layui-form-label")&&t.parents(".layui-form-pane")[0]){a=a>36?a+4:a;!a&&(a=36);t.css("height",a+"px");i.css({height:a+2+"px",lineHeight:a-18+"px"})}}var r=t.find("."+g+" input"),l=!e.find("span:last")[0]&&!t.find("."+y).val();if(l){var s=r.attr("back");r.removeAttr("back");r.attr("placeholder",s)}else{var o=r.attr("placeholder");r.removeAttr("placeholder");r.attr("back",o)}};t.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++){if(e[n].val==t||e[n].val==(t?t.val:t)||e[n]==t||JSON.stringify(e[n])==JSON.stringify(t)){return n}}return-1};t.prototype.remove=function(e,t){var n=this.indexOf(e,t?t.val:t);if(n>-1){e.splice(n,1);return true}return false};t.prototype.selectAll=function(a,i,e){var r=this;var l=G('[xid="'+a+'"]');if(!l[0]){return}if(l.find(".xm-select-linkage")[0]){return}l.find("dd[lay-value]:not(."+B+"):not(."+x+")"+(e?":not(."+N+")":"")).each(function(e,t){t=G(t);var n={name:t.find("span").attr("name"),val:t.attr("lay-value")};r.handlerLabel(a,l.find('dd[lay-value="'+n.val+'"]'),true,n,!i)})};t.prototype.removeAll=function(n,a,i){var r=this;var l=G('[xid="'+n+'"]');if(!l[0]){return}if(l.find(".xm-select-linkage")[0]){z[n].values.concat([]).forEach(function(e,t){var n=e.val.split("/");var a=void 0,i=void 0,r=0;do{a=n[r++];i=l.find(".xm-select-linkage-group"+r+':not(.xm-select-linkage-hide) li[value="'+a+'"]');i.click()}while(i.length&&a!=undefined)});return}z[n].values.concat([]).forEach(function(e,t){if(i&&l.find('dd[lay-value="'+e.val+'"]').hasClass(N)){}else{r.handlerLabel(n,l.find('dd[lay-value="'+e.val+'"]'),false,e,!a)}})};t.prototype.reverse=function(a,i,e){var r=this;var l=G('[xid="'+a+'"]');if(!l[0]){return}if(l.find(".xm-select-linkage")[0]){return}l.find("dd[lay-value]:not(."+B+")"+(e?":not(."+N+")":"")).each(function(e,t){t=G(t);var n={name:t.find("span").attr("name"),val:t.attr("lay-value")};r.handlerLabel(a,l.find('dd[lay-value="'+n.val+'"]'),!t.hasClass(x),n,!i)})};t.prototype.skin=function(e){var t=["default","primary","normal","warm","danger"];var n=t[Math.floor(Math.random()*t.length)];G('dl[xid="'+e+'"]').parents("."+v).find("."+I).attr("xm-select-skin",n);this.check(e)&&this.commonHanler(e,G('dl[xid="'+e+'"]').parents("."+v).find("."+k))};t.prototype.getPosition=function(e){var t=0,n=0;while(e!=null){t+=e.offsetLeft;n+=e.offsetTop;e=e.offsetParent}return{x:t,y:n}};t.prototype.onreset=function(){G(document).on("click","[type=reset]",function(e){G(e.target).parents("form").find("."+v+" dl[xid]").each(function(e,t){var n=t.getAttribute("xid"),a=G(t),i=void 0,r={};u.removeAll(n);z[n].config.init.forEach(function(e,t){if(e&&(!r[e]||z[n].config.repeat)&&(i=a.find('dd[lay-value="'+e.val+'"]'))[0]){u.handlerLabel(n,i,true);r[e]=1}})})})};t.prototype.bindEvent=function(n,e,a){if(e&&e instanceof Function){a=e;e=null}if(a&&a instanceof Function){if(!e){G.each(z,function(e,t){z[e]?z[e].config[n]=a:Q[n][e]=a})}else{z[e]?(z[e].config[n]=a,delete Q[n][e]):Q[n][e]=a}}};t.prototype.check=function(e){if(G('dl[xid="'+e+'"]').length||G('select[xm-select="'+e+'"]').length){return true}else{delete z[e];return false}};t.prototype.render=function(e,t){u.init(t);u.one(G('dl[xid="'+e+'"]').parents("."+v));u.initVal(e)};var c=function e(){var s=this;this.v=n;this.render();if(o){var t={};t.install=function(e,t){e.directive("xm-select",function(e,t,a,n){var i=t.value,r=i.id,l=i.vals;e.setAttribute("xm-select",r);setTimeout(function(){s.render(r,{init:l?l.concat([]):null});if(a.children._isVList&&u.check(r)){var n=Y[r]?Y[r]:X;s.data(r,"local",{arr:a.children.map(function(e){var t={};if(e.data&&e.data.domProps){t[n["keyName"]]=e.data.domProps.textContent;t[n["keyVal"]]=e.data.domProps.value}e.data&&e.data.attrs&&(t[n["keyDis"]]=e.data.attrs.disabled);return t})}).value(r,l)}},10)})};o.use(t)}};var u=new t;c.prototype.value=function(a,e,t){if(typeof a!="string"){return[]}var i=z[a];if(!u.check(a)){return[]}if(typeof e=="string"||e==undefined){var n=i.values.concat([])||[];if(e=="val"){return n.map(function(e){return e.val})}if(e=="valStr"){return n.map(function(e){return e.val}).join(",")}if(e=="name"){return n.map(function(e){return e.name})}if(e=="nameStr"){return n.map(function(e){return e.name}).join(",")}return n}if(u.isArray(e)){var r=G('[xid="'+a+'"]'),l={},s=void 0,o=true;if(t==false){o=false}else if(t==true){o=true}else{u.removeAll(a)}if(o){i.values.forEach(function(e,t){l[e.val]=1})}e.forEach(function(e,t){if(e&&(!l[e]||i.config.repeat)){if((s=r.find('dd[lay-value="'+e+'"]'))[0]){u.handlerLabel(a,s,o,null,true);l[e]=1}else{var n=u.valToName(a,e);if(n){u.handlerLabel(a,s,o,{name:n,val:e},true);l[e]=1}}}})}};c.prototype.on=function(e,t,n){u.bindEvent(n?"endOn":"on",e,t);return this};c.prototype.filter=function(e,t){u.bindEvent("filter",e,t);return this};c.prototype.maxTips=function(e,t){u.bindEvent("maxTips",e,t);return this};c.prototype.config=function(e,n,t){if(e&&(typeof e==="undefined"?"undefined":_typeof(e))=="object"){t=n==true;n=e;e=null}if(n&&(typeof n==="undefined"?"undefined":_typeof(n))=="object"){if(t){n.header||(n.header={});n.header["Content-Type"]="application/json; charset=UTF-8";n.dataType="json"}e?(Y[e]=G.extend(true,{},Y[e]||X,n),!u.check(e)&&this.render(e),z[e]&&n.direction&&(z[e].config.direction=n.direction),z[e]&&n.clearInput&&(z[e].config.clearInput=true),n.searchUrl&&z[e]&&u.triggerSearch(G("."+v+' dl[xid="'+e+'"]').parents("."+I),true)):(G.extend(true,X,n),G.each(Y,function(e,t){G.extend(true,t,n)}))}return this};c.prototype.render=function(e,t){if(e&&(typeof e==="undefined"?"undefined":_typeof(e))=="object"){t=e;e=null}var n=t?{init:t.init,disabled:t.disabled,max:t.max,isSearch:t.isSearch,searchUrl:t.searchUrl,isCreate:t.isCreate,radio:t.radio,skin:t.skin,direction:t.direction,height:t.height,formname:t.formname,layverify:t.layverify,layverType:t.layverType,searchType:t.searchType=="dl"?1:0,showCount:t.showCount,placeholder:t.placeholder,create:t.create,filter:t.filter,maxTips:t.maxTips,on:t.on,template:t.template,clearInput:t.clearInput}:{};if(e&&!u.check(e)){return this}if(e){i[e]={};G.extend(i[e],n)}else{G.extend(a,n)}(G("select["+m+'="'+e+'"]')[0]?G("select["+m+'="'+e+'"]'):G("select["+m+"]")).each(function(e,t){var n=t.getAttribute(m);u.render(n,t);setTimeout(function(){return u.setHidnVal(n,G('select[xm-select="'+n+'"] + div.'+v+" ."+k))},10)});return this};c.prototype.disabled=function(e){var t={};e?u.check(e)&&(t[e]=z[e]):t={};G.each(t,function(e,t){G('dl[xid="'+e+'"]').prev().addClass(H)});return this};c.prototype.undisabled=function(e){var t={};e?u.check(e)&&(t[e]=z[e]):t={};G.each(t,function(e,t){G('dl[xid="'+e+'"]').prev().removeClass(H)});return this};c.prototype.data=function(e,t,n){if(!e||!t||!n){return this}!u.check(e)&&this.render(e);this.value(e,[]);this.config(e,n);if(t=="local"){u.renderData(e,n.arr,n.linkage==true,n.linkageWidth?n.linkageWidth:"100")}else if(t=="server"){u.ajax(e,n.url,n.keyword,n.linkage==true,n.linkageWidth?n.linkageWidth:"100")}return this};c.prototype.btns=function(e,s,o){if(e&&u.isArray(e)){s=e;e=null}if(!s||!u.isArray(s)){return this}var t={};e?u.check(e)&&(t[e]=z[e]):t=z;s=s.map(function(e){if(typeof e=="string"){if(e=="select"){return $[0]}if(e=="remove"){return $[1]}if(e=="reverse"){return $[2]}if(e=="skin"){return $[3]}}return e});G.each(t,function(e,t){t.config.btns=s;var n=G('dl[xid="'+e+'"]').find("."+B+":first");if(s.length){var a=o&&o.show&&(o.show=="name"||o.show=="icon")?o.show:"";var i=u.renderBtns(e,a,o&&o.space?o.space:"30px");n.html(i)}else{var r=n.parents("."+I).find("."+g+" input");var l=r.attr("placeholder")||r.attr("back");n.html(l);n.removeAttr("style")}});return this};c.prototype.search=function(e,t){if(e&&u.check(e)){Y[e]=G.extend(true,{},Y[e]||X,{first:true,searchVal:t});u.triggerSearch(G('dl[xid="'+e+'"]').parents("."+I),true)}return this};return new c});